"use strict";(self.webpackChunk_availity_dinosaurdocs=self.webpackChunk_availity_dinosaurdocs||[]).push([[317],{3023:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>r});var a=n(3696);const o={},s=a.createContext(o);function i(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),a.createElement(s.Provider,{value:t},e.children)}},3923:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"tutorial/mocks","title":"Bring on the Mocks","description":"When developing Availity applications there is no use in a UI that doesn\'t connect to some data source. There are a few ways a developer can get data when developing locally:","source":"@site/docs/tutorial/mocks.md","sourceDirName":"tutorial","slug":"/tutorial/mocks","permalink":"/availity-workflow/tutorial/mocks","draft":false,"unlisted":false,"editUrl":"https://github.com/availity/availity-workflow/edit/master/docusaurus/docs/tutorial/mocks.md","tags":[],"version":"current","frontMatter":{"title":"Bring on the Mocks"},"sidebar":"someSidebar","previous":{"title":"Getting Started","permalink":"/availity-workflow/tutorial/"},"next":{"title":"Creating a Deployment","permalink":"/availity-workflow/tutorial/deploy"}}');var o=n(2540),s=n(3023),i=n(3254);const r={title:"Bring on the Mocks"},l=void 0,c={},d=[{value:"Mock Data Structure",id:"mock-data-structure",level:2},{value:"Starting Mock Server",id:"starting-mock-server",level:2},{value:"Example",id:"example",level:2},{value:"Adding API Code Snippet",id:"adding-api-code-snippet",level:3},{value:"Adding a new Route",id:"adding-a-new-route",level:3},{value:"Adding Response Data",id:"adding-response-data",level:3}];function h(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"When developing Availity applications there is no use in a UI that doesn't connect to some data source. There are a few ways a developer can get data when developing locally:"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Proxy requests from the local webpack-dev-server to the target API environment and have the proxy handle the authentication."}),"\n",(0,o.jsx)(t.li,{children:"Spin up a local mock server to accept inbound requests and respond with fake data."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Lucky for you, we have built a local mock server into workflow that will return mock data for most of the APIs that we support."}),"\n",(0,o.jsx)(t.h2,{id:"mock-data-structure",children:"Mock Data Structure"}),"\n",(0,o.jsx)("img",{width:"100%",src:(0,i.Ay)("img/mock-data.png"),alt:"Mock Data Structure"}),"\n",(0,o.jsxs)(t.p,{children:["Inside of the ",(0,o.jsx)(t.code,{children:"config"})," folder is a file titled ",(0,o.jsx)(t.code,{children:"routes.json"}),". This contains an object ",(0,o.jsx)(t.code,{children:"key/value"})," pair of all the API routes you override from your UI."]}),"\n",(0,o.jsxs)(t.p,{children:["In our case, we have an API call being made that requests data from ",(0,o.jsx)(t.code,{children:"/ms/api/availity/internal/spc/slotmachine/graphql"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["The key of the nested object is a ",(0,o.jsx)(t.code,{children:"file"})," type, thus we specify its a ",(0,o.jsx)(t.code,{children:"file"})," and the value is the path to the data file we want returned."]}),"\n",(0,o.jsxs)(t.p,{children:['The above pictured scenario can be explained by saying "the specified path will return JSON containing the data from the file ',(0,o.jsx)(t.code,{children:"data/slotmachine.data"}),". Note that the JSON will be returned for any type of request method, and parameters passed in. See the full list of ",(0,o.jsx)(t.a,{href:"/reference/mock-server/#route-configuration-examples",children:"examples"})," for more advanced configurations."]}),"\n",(0,o.jsx)(t.h2,{id:"starting-mock-server",children:"Starting Mock Server"}),"\n",(0,o.jsxs)(t.p,{children:["By default, if you have not modified your ",(0,o.jsx)(t.code,{children:"workflow.js"})," file the mock server will automatically start up and be running. This can be disabled by setting ",(0,o.jsx)(t.code,{children:"development.mock.enabled"})," to ",(0,o.jsx)(t.code,{children:"false"})," in the configuration file."]}),"\n",(0,o.jsxs)(t.p,{children:["The easiest way to know if the server is running is you should see a message saying ",(0,o.jsx)(t.code,{children:"Ekko server started at..."}),"."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-shell",metastring:"hideCopy=true",children:"Workspaces/workflow-app is \ud83d\udce6 v0.1.0 via \u2b22 v12.14.0 took 11s 487ms yarn start\nyarn run v1.21.1\n$ av start\n\u203a REACT\n\u203a Using project/config/workflow.js\n\u203a Using @availity/workflow/public/index.html\n\u203a Using @availity/workflow/public/favicon.ico\n\u203a Webpack 0% compiling\n\u203a Webpack 10% building\n\u203a Proxy created: [ '/api', '/ms' ] -> http://localhost:51484\n\u203a Proxy rewrite rule created: \"^/api\" ~> \"\"\n\u2139 \uff62wds\uff63: Project is running at http://localhost:3000/\n\u2139 \uff62wds\uff63: webpack output is served from undefined\n\u2139 \uff62wds\uff63: Content not from webpack is served from /Users/kgray/Workspaces/proving-grounds/workflow-app/build\n\u2139 \uff62wds\uff63: 404s will fallback to /index.html\n\u203a Started development server\n\u203a Loading plugin @availity/mock-data\n\u203a Ekko server started at http://localhost:51484\n"})}),"\n",(0,o.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,o.jsx)(t.p,{children:"The best way to learn is by examples and that is what we are going to do here."}),"\n",(0,o.jsxs)(t.p,{children:["We are going to clear out the ",(0,o.jsx)(t.code,{children:"App.js"})," file for testing purposes and instead paste the below code snippet."]}),"\n",(0,o.jsx)(t.h3,{id:"adding-api-code-snippet",children:"Adding API Code Snippet"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",metastring:"header=App.js",children:"import React, { useEffect, useState } from 'react';\nimport { avUserApi } from '@availity/api-axios';\n\nconst App = () => {\n    const [name, setName] = useState(''); // initialize state\n\n    // Fetch the user on component mount\n    useEffect(() => {\n        const fetchData = async () => {\n            const user = await avUserApi.me(); // Request current user\n\n            setName(user.firstName); // set the name to state\n        };\n\n        fetchData();\n    }, []);\n\n    return <div>Hello {name}</div>;\n};\n\nexport default App;\n"})}),"\n",(0,o.jsxs)(t.p,{children:["The above code snippet runs a method called ",(0,o.jsx)(t.code,{children:"fetchData"})," on mount that will fetch the user's ",(0,o.jsx)(t.code,{children:"firstName"})," using the ",(0,o.jsx)(t.code,{children:"avUserApi"})," from ",(0,o.jsx)(t.code,{children:"@availity/api-axios"}),". You can read more on what that resource looks like ",(0,o.jsx)(t.a,{href:"https://github.com/Availity/sdk-js/tree/master/packages/api-axios",children:"here"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["Since we know the route is going to look like ",(0,o.jsx)(t.code,{children:"api/sdk/platform/v1/users/me"})," we can mock it out in the ",(0,o.jsx)(t.code,{children:"routes.json"})," by adding the following to our file:"]}),"\n",(0,o.jsx)(t.h3,{id:"adding-a-new-route",children:"Adding a new Route"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-json",metastring:"header=routes.json",children:'{\n    "ms/api/availity/internal/spc/slotmachine/graphql": {\n        "file": "slotmachine.json"\n    },\n    "sdk/platform/v1/users/me": {\n        "file": "user.json"\n    }\n}\n'})}),"\n",(0,o.jsxs)(t.p,{children:["Note that we can strip the prefixing ",(0,o.jsx)(t.code,{children:"/api"})," as the mock server takes that off automatically."]}),"\n",(0,o.jsx)(t.h3,{id:"adding-response-data",children:"Adding Response Data"}),"\n",(0,o.jsxs)(t.p,{children:["Now that we have the route we need to mock out our ",(0,o.jsx)(t.code,{children:"user.json"})," response:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-json",metastring:"header=user.json",children:'{\n    "firstName": "Kyle"\n}\n'})}),"\n",(0,o.jsxs)(t.p,{children:["We added a simple response object with one key that is the ",(0,o.jsx)(t.code,{children:"firstName"})," used to render in the App."]}),"\n",(0,o.jsx)(t.p,{children:"If your application is currently running you will need to restart it as the mock server will need to be restarted in order to get the updated mock data."}),"\n",(0,o.jsx)(t.p,{children:"If all goes correct you should see the Application rendering"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",metastring:"hideCopy=true",children:"Hello Kyle\n"})}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsxs)(t.p,{children:["For more examples you checkout the ",(0,o.jsx)(t.a,{href:"/reference/mock-server/#route-configuration-examples",children:"mock server reference page"}),"."]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Congratulations on making it this far! By now you should be able to fully build out an application API ready. Next we will discuss the build steps that workflow provides and how to get your application deployed on our portal."})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);